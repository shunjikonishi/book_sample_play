"undefined"==typeof bookstore&&(bookstore={}),function(a){"use strict";bookstore.Application=function(){function b(){c(location.pathname,!1),a(window).on("popstate",function(a){var b=a.originalEvent.state||"/";c(b)})}function c(a,b){switch(a){case"/":h();break;case"/books":i();break;case"/shops":j();break;case"/books/with_quantity":l();break;default:if(0===a.indexOf("/shops/")){k(a.substring("/shops/".length));break}m(a)}b&&d(a)}function d(a){history.pushState&&history.pushState(a,null,a)}function e(){a("#breadcrumb-home").click(function(){return c("/",!0),!1}),a("#breadcrumb-shops").click(function(){return c("/shops",!0),!1})}function f(b){a.ajax(b)}function g(a,b){f({url:"/templates/"+a,success:b})}function h(){o.load(p,"index",function(){a("#index-books").click(function(){return c("/books",!0),!1}),a("#index-shops").click(function(){return c("/shops",!0),!1}),a("#index-books-with-quantity").click(function(){return c("/books/with_quantity",!0),!1})})}function i(){f({url:"/books",type:"POST",success:function(b){o.load(p,"books",function(){e(),ko.applyBindings({books:b},a("#books-tbody")[0])})}})}function j(){f({url:"/shops",type:"POST",success:function(b){o.load(p,"shops",function(){var d=a("#shops-list");e(),ko.applyBindings({shops:b},d[0]),d.find("a").click(function(){var b=a(this).attr("data-id");return c("/shops/"+b,!0),!1})})}})}function k(b){f({url:"/shops/"+b,type:"POST",success:function(b){o.load(p,"shopDetail",function(){e(),a("#shop-name").text(b.shop.name),ko.applyBindings(b,a("#shop-books-tbody")[0])})}})}function l(){f({url:"/books/with_quantity",type:"POST",success:function(b){o.load(p,"booksWithQuantity",function(){e(),ko.applyBindings({books:b},a("#books-tbody")[0])})}})}function m(a){p.text("Not found: "+a)}var n=new room.Cache(sessionStorage),o=new room.TemplateManager(n,g),p=a("#container");n.clear(),o.save("index",p.html()),b()}}(jQuery);